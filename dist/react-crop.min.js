!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.ReactCrop=e(require("react")):t.ReactCrop=e(t.react)}(this,function(t){return function(t){function e(s){if(i[s])return i[s].exports;var a=i[s]={exports:{},id:s,loaded:!1};return t[s].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};return e.m=t,e.c=i,e.p="/",e(0)}([function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),n=s(a),o=i(2),r=s(o),h=i(3),l=s(h);e["default"]=n["default"].createClass({displayName:"Cropper",propTypes:{width:n["default"].PropTypes.number.isRequired,height:n["default"].PropTypes.number.isRequired,center:n["default"].PropTypes.bool,image:n["default"].PropTypes.any,widthLabel:n["default"].PropTypes.string,heightLabel:n["default"].PropTypes.string,offsetXLabel:n["default"].PropTypes.string,offsetYLabel:n["default"].PropTypes.string,onImageLoaded:n["default"].PropTypes.func,minConstraints:n["default"].PropTypes.arrayOf(n["default"].PropTypes.number)},getDefaultProps:function(){return{center:!1,width:"Width",height:"Height",offsetXLabel:"Offset X",offsetYLabel:"Offset Y"}},getInitialState:function(){return{imageLoaded:!1,width:this.props.width,height:this.props.height,url:window.URL.createObjectURL(this.props.image)}},componentWillReceiveProps:function(t){this.props.image!==t.image&&this.setState({url:window.URL.createObjectURL(t.image),imageLoaded:!1})},shouldComponentUpdate:function(t,e){var i=this.props.image;return t.image.size!==i.size||t.image.name!==i.name||t.image.type!==i.type||e.imageLoaded!==this.state.imageLoaded},onLoad:function(t){var e=this,i=this.refs.box.getBoundingClientRect();this.setState({imageLoaded:!0,width:i.width,height:i.height},function(){var t=e.refs.image;e.props.onImageLoaded&&e.props.onImageLoaded(t)})},cropImage:function(){var t=this;return new Promise(function(e,i){var s=new Image;s.onload=function(){var i=t.refs.canvas,s=t.refs.image,a=i.getContext("2d"),n=s.naturalWidth/t.state.width,o=s.naturalHeight/t.state.height,r=1>n?0:t.state.offset.left*n,h=1>o?0:t.state.offset.top*o,p=1>n?s.naturalWidth:t.state.dimensions.width*n,u=1>o?s.naturalHeight:t.state.dimensions.height*o,d=1>n?Math.floor((t.state.dimensions.width-s.naturalWidth)/2):0,c=1>o?Math.floor((t.state.dimensions.height-s.naturalHeight)/2):0,f=1>n?s.naturalWidth:t.props.width,g=1>o?s.naturalHeight:t.props.height;a.clearRect(0,0,t.props.width,t.props.height),a.drawImage(s,r,h,p,u,d,c,f,g),e(l["default"](i.toDataURL()))},s.src=window.URL.createObjectURL(t.props.image)})},onChange:function(t,e){this.setState({offset:t,dimensions:e})},render:function(){return n["default"].createElement("div",{ref:"box",className:"Cropper",style:{minWidth:this.props.width,minHeight:this.props.height}},n["default"].createElement("canvas",{className:"Cropper-canvas",ref:"canvas",width:this.props.width,height:this.props.height}),n["default"].createElement("img",{ref:"image",src:this.state.url,className:"Cropper-image",onLoad:this.onLoad,style:{top:this.state.height/2}}),this.state.imageLoaded&&n["default"].createElement("div",{className:"box"},n["default"].createElement(r["default"],{aspectRatio:this.props.width/this.props.height,width:this.state.width,height:this.state.height,minConstraints:this.props.minConstraints,onChange:this.onChange,widthLabel:this.props.widthLabel,heightLabel:this.props.heightLabel,offsetXLabel:this.props.offsetXLabel,offsetYLabel:this.props.offsetYLabel},n["default"].createElement("div",{className:"Cropper-box"}))))}}),t.exports=e["default"]},function(e,i){e.exports=t},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var i=[],s=!0,a=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(s=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(h){a=!0,n=h}finally{try{!s&&r["return"]&&r["return"]()}finally{if(a)throw n}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=i(1),o=s(n);e["default"]=o["default"].createClass({displayName:"DraggableResizableBox",propTypes:{aspectRatio:o["default"].PropTypes.number.isRequired,width:o["default"].PropTypes.number.isRequired,height:o["default"].PropTypes.number.isRequired,onChange:o["default"].PropTypes.func,offset:o["default"].PropTypes.array,minConstraints:o["default"].PropTypes.array,children:o["default"].PropTypes.node,widthLabel:o["default"].PropTypes.string,heightLabel:o["default"].PropTypes.string,offsetXLabel:o["default"].PropTypes.string,offsetYLabel:o["default"].PropTypes.string},getDefaultProps:function(){return{widthLabel:"Width",heightLabel:"Height",offsetXLabel:"Offset X",offsetYLabel:"Offset Y"}},getInitialState:function(){var t=this.preserveAspectRatio(this.props.width,this.props.height),e=a(t,2),i=e[0],s=e[1],n=(this.props.height-s)/2,o=(this.props.width-i)/2;return{top:n,left:o,bottom:n,right:o,width:i,height:s}},componentDidMount:function(){document.addEventListener("mousemove",this.eventMove),document.addEventListener("mouseup",this.eventEnd),document.addEventListener("touchmove",this.eventMove),document.addEventListener("touchend",this.eventEnd),document.addEventListener("keydown",this.handleKey),this.props.onChange({top:this.state.top,left:this.state.left},{width:this.state.width,height:this.state.height})},componentWillUnmount:function(){document.removeEventListener("mousemove",this.eventMove),document.removeEventListener("mouseup",this.eventEnd),document.removeEventListener("touchmove",this.eventMove),document.removeEventListener("touchend",this.eventEnd),document.removeEventListener("keydown",this.handleKey)},calculateDimensions:function(t){var e=t.top,i=t.left,s=t.bottom,a=t.right;return{width:this.props.width-i-a,height:this.props.height-e-s}},preserveAspectRatio:function(t,e){this.props.minConstraints&&(t=Math.max(t,this.props.minConstraints[0]),e=Math.max(e,this.props.minConstraints[1]));var i=t/e;return i<this.props.aspectRatio?[t,t/this.props.aspectRatio]:i>this.props.aspectRatio?[e*this.props.aspectRatio,e]:[t,e]},constrainBoundary:function(t){return 0>t?0:t},getClientCoordinates:function(t){return t.touches?{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}:{clientX:t.clientX,clientY:t.clientY}},eventMove:function(t){this.state.resizing?this.onResize(t):this.state.moving&&this.eventMoveBox(t)},eventEnd:function(t){this.state.resizing?this.stopResize(t):this.state.moving&&this.stopMove(t)},startResize:function(t,e){e.stopPropagation(),e.preventDefault(),this.setState({resizing:!0,corner:t})},stopResize:function(){this.setState({resizing:!1})},nw:function(t,e){var i=Object.assign({},this.state,{top:this.constrainBoundary(t.clientY-e.top),left:this.constrainBoundary(t.clientX-e.left)}),s=this.calculateDimensions(i),n=this.preserveAspectRatio(s.width,s.height),o=a(n,2),r=o[0],h=o[1];return i.top=this.props.height-i.bottom-h,i.left=this.props.width-i.right-r,i},ne:function(t,e){var i=Object.assign({},this.state,{top:this.constrainBoundary(t.clientY-e.top),right:this.constrainBoundary(e.right-t.clientX)}),s=this.calculateDimensions(i),n=this.preserveAspectRatio(s.width,s.height),o=a(n,2),r=o[0],h=o[1];return i.top=this.props.height-i.bottom-h,i.right=this.props.width-i.left-r,i},se:function(t,e){var i=Object.assign({},this.state,{bottom:this.constrainBoundary(e.bottom-t.clientY),right:this.constrainBoundary(e.right-t.clientX)}),s=this.calculateDimensions(i),n=this.preserveAspectRatio(s.width,s.height),o=a(n,2),r=o[0],h=o[1];return i.bottom=this.props.height-i.top-h,i.right=this.props.width-i.left-r,i},sw:function(t,e){var i=Object.assign({},this.state,{bottom:this.constrainBoundary(e.bottom-t.clientY),left:this.constrainBoundary(t.clientX-e.left)}),s=this.calculateDimensions(i),n=this.preserveAspectRatio(s.width,s.height),o=a(n,2),r=o[0],h=o[1];return i.bottom=this.props.height-i.top-h,i.left=this.props.width-i.right-r,i},onResize:function(t){var e=this.refs.box.parentElement.parentElement.getBoundingClientRect(),i=this.getClientCoordinates(t),s=this[this.state.corner](i,e);this.resize(s,i)},controlsResize:function(t){var e=this.refs.box.parentElement.parentElement.getBoundingClientRect(),i="width"===t.target.name?+t.target.value:+t.target.value*this.props.aspectRatio,s="height"===t.target.name?+t.target.value:+t.target.value/this.props.aspectRatio,a=this.preserveAspectRatio(i,s);if(i=a[0],s=a[1],!(i>e.width-this.state.left||s>e.height-this.state.top)){var n=this.state.width-i,o=this.state.height-s,r=Object.assign({},this.state,{right:this.state.right+n,bottom:this.state.bottom+o}),h={clientX:e.right-r.right,clientY:e.bottom-r.bottom};this.resize(r,h)}},resize:function(t,e){var i=this,s=this.calculateDimensions(t),a=s.width!==this.state.width,n=s.height!==this.state.height;(a||n)&&this.setState(Object.assign({},e,t,s),function(){i.props.onChange({top:t.top,left:t.left},s)})},startMove:function(t){var e=this.getClientCoordinates(t),i=e.clientX,s=e.clientY;this.setState({moving:!0,clientX:i,clientY:s})},stopMove:function(t){this.setState({moving:!1})},eventMoveBox:function(t){t.preventDefault();var e=this.getClientCoordinates(t),i=e.clientX,s=e.clientY,a=i-this.state.clientX,n=s-this.state.clientY;this.moveBox(i,s,a,n)},controlsMoveBox:function(t){var e="x"===t.target.name?t.target.value-this.state.left:0,i="y"===t.target.name?t.target.value-this.state.top:0;this.moveBox(0,0,e,i)},moveBox:function(t,e,i,s){var a=this,n={top:this.constrainBoundary(this.state.top+s),left:this.constrainBoundary(this.state.left+i),bottom:this.constrainBoundary(this.state.bottom-s),right:this.constrainBoundary(this.state.right-i)};n.top||(n.bottom=this.props.height-this.state.height),n.bottom||(n.top=this.props.height-this.state.height),n.left||(n.right=this.props.width-this.state.width),n.right||(n.left=this.props.width-this.state.width),this.setState(Object.assign({},{clientX:t,clientY:e},n),function(){a.props.onChange({top:n.top,left:n.left},a.calculateDimensions(n))})},keyboardResize:function(t){if(!(this.state.right-t<0||this.state.bottom-t<0)){var e=this.preserveAspectRatio(this.state.width+t,this.state.height+t),i=a(e,2),s=i[0],n=i[1],o=s-this.state.width,r=n-this.state.height;this.setState({bottom:this.state.bottom-r,right:this.state.right-o,width:s,height:n})}},handleKey:function(t){t.shiftKey?"ArrowUp"===t.key?(this.keyboardResize(-10),t.preventDefault()):"ArrowDown"===t.key?(this.keyboardResize(10),t.preventDefault()):"ArrowLeft"===t.key?(this.keyboardResize(-10),t.preventDefault()):"ArrowRight"===t.key&&(this.keyboardResize(10),t.preventDefault()):"ArrowUp"===t.key?(this.moveBox(this.state.clientX,this.state.clientY,0,-10),t.preventDefault()):"ArrowDown"===t.key?(this.moveBox(this.state.clientX,this.state.clientY,0,10),t.preventDefault()):"ArrowLeft"===t.key?(this.moveBox(this.state.clientX,this.state.clientY,-10,0),t.preventDefault()):"ArrowRight"===t.key&&(this.moveBox(this.state.clientX,this.state.clientY,10,0),t.preventDefault())},render:function(){var t={position:"absolute",top:this.state.top,left:this.state.left,right:this.state.right,bottom:this.state.bottom},e=this.calculateDimensions(this.state),i=e.width,s=e.height,a={height:this.state.top},n={height:this.state.bottom},r={top:this.state.top,right:i+this.state.right,bottom:this.state.bottom},h={top:this.state.top,left:i+this.state.left,bottom:this.state.bottom};return o["default"].createElement("div",{ref:"box",className:"DraggableResizable"},o["default"].createElement("div",{className:"DraggableResizable-controls"},o["default"].createElement("label",null,this.props.offsetXLabel,o["default"].createElement("input",{name:"x",value:Math.round(this.state.left),onChange:this.controlsMoveBox,tabIndex:"-1",type:"number"})),o["default"].createElement("label",null,this.props.offsetYLabel,o["default"].createElement("input",{name:"y",value:Math.round(this.state.top),onChange:this.controlsMoveBox,tabIndex:"-1",type:"number"})),o["default"].createElement("label",null,this.props.widthLabel,o["default"].createElement("input",{name:"width",value:Math.round(i),type:"number",tabIndex:"-1",onChange:this.controlsResize})),o["default"].createElement("label",null,this.props.heightLabel,o["default"].createElement("input",{value:Math.round(s),type:"number",name:"height",tabIndex:"-1",onChange:this.controlsResize}))),o["default"].createElement("div",{className:"DraggableResizable-top",style:a}),o["default"].createElement("div",{className:"DraggableResizable-left",style:r}),o["default"].createElement("div",{style:t,onMouseDown:this.startMove,onTouchStart:this.startMove},this.props.children,o["default"].createElement("div",{className:"resize-handle resize-handle-se",onMouseDown:this.startResize.bind(null,"se"),onTouchStart:this.startResize.bind(null,"se")}),o["default"].createElement("div",{className:"resize-handle resize-handle-ne",onMouseDown:this.startResize.bind(null,"ne"),onTouchStart:this.startResize.bind(null,"ne")}),o["default"].createElement("div",{className:"resize-handle resize-handle-sw",onMouseDown:this.startResize.bind(null,"sw"),onTouchStart:this.startResize.bind(null,"sw")}),o["default"].createElement("div",{className:"resize-handle resize-handle-nw",onMouseDown:this.startResize.bind(null,"nw"),onTouchStart:this.startResize.bind(null,"nw")})),o["default"].createElement("div",{className:"DraggableResizable-right",style:h}),o["default"].createElement("div",{className:"DraggableResizable-bottom",style:n}))}}),t.exports=e["default"]},function(t,e){function i(t){return t.split(";")[0].slice(5)}var s=window.Blob,a=100==new s([new Uint8Array(100)]).size;t.exports=function(t){for(var e=t.split(",")[1],n=atob(e),o=new ArrayBuffer(n.length),r=new Uint8Array(o),h=0;h<n.length;h++)r[h]=n.charCodeAt(h);a||(r=o);var l=new s([r],{type:i(t)});return l.slice=l.slice||l.webkitSlice,l}}])});
//# sourceMappingURL=react-crop.min.js.map